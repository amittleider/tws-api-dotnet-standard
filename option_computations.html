<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>TWS API v9.72: Options Computations</title>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="https://www.interactivebrokers.com/favicon.ico" rel="shortcut icon">
<script>
$(document).ready(function(){
		var picked=getCookie("picked");
		if (picked != "") {
			if (!$(this).hasClass("active")) {
				var tabNum = $(this).index();
				var nthChild = picked;
				$("ul#tabs li.active").removeClass("active");
				$(this).addClass("active");
				$("ul#tab li.active").removeClass("active");
				$("ul#tab li:nth-child("+nthChild+")").addClass("active");
				$("ul#tabs li:nth-child("+nthChild+")").addClass("active");
				setCookie("picked", nthChild, 1);
			}
		}
		$("ul#tabs li").click(function(e){
			if (!$(this).hasClass("active")) {
			var tabNum = $(this).index();
			var nthChild = tabNum+1;
			$("ul#tabs li.active").removeClass("active");
			$(this).addClass("active");
			$("ul#tab li.active").removeClass("active");
			$("ul#tab li:nth-child("+nthChild+")").addClass("active");
			setCookie("picked", nthChild, 1);
		}
    });
});
function setCookie(cname, cvalue, exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    var expires = "expires="+d.toUTCString();
    document.cookie = cname + "=" + cvalue + "; " + expires;
} 
function getCookie(cname) {
    var name = cname + "=";
    var ca = document.cookie.split(';');
    for(var i=0; i<ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1);
        if (c.indexOf(name) == 0) return c.substring(name.length,c.length);
    }
    return "";
} 
function checkCookie() {
    var picked=getCookie("picked");
    if (picked != "") {
        alert("Welcome again " + picked);
    }else{
        //username = prompt("Please enter your name:", "");
        if (picked != "" && picked != null) {
            setCookie("picked", 1, 365);
        }
    }
}
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ib_theme.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" style="background-color:black;">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr>
  <td id="projectlogo"><img alt="Logo" src="nav_iblogo.png"/></a></td>
  <td style="padding: 0 0 0 1em;">
   <ul id="tabs"><li class="active">C#</li><li>Java</li><li>VB</li><li>C++</li><li>Python</li></ul>
  </td>
  <td><a href="mailto:api@interactivebrokers.com?subject=TWS API Documentation" style="color:#C7C7C7;font-weight:bold;padding: 0 0 0 1em;">Contact us</a></td>
  <!--BEGIN GCS_SEARCHBOX-->
  <td style="position: absolute; right: 0;">
   <div id="google-custom-search" align="right" style="vertical-align: top;">
   <script>
  (function() {
    var cx = '002885114636493240026:q6smajphkxq';
	var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
	</script>
	<gcse:search newWindow="false" enableHistory="true"></gcse:search>
   </div>
   </td>
  <!--END !GCS_SEARCHBOX-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('option_computations.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Options Computations </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="option_greeks"></a>
Market data related to options</h1>
<p>The option greek values- delta, gamma, theta, vega- are returned by default following a reqMktData() request for the option. See <a class="el" href="tick_types.html">Available Tick Types</a></p>
<p>Tick types BID_OPTION_COMPUTATION (#10), ASK_OPTION_COMPUTATION (#11), LAST_OPTION_COMPUTATION (#12), and MODEL_OPTION_COMPUTATION (#13) return all Greeks (delta, gamma, vega, theta), the underlying price and the stock and option reference price when requested.</p>
<p>MODEL_OPTION_COMPUTATION also returns model implied volatility.</p>
<p>Note that to receive greek values it is necessary to have market data subscriptions for both the option and the underlying contract.</p>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">            <span class="comment">//Requesting data for an option contract will return the greek values</span></div>
<div class="line">            client.reqMktData(1002, ContractSamples.OptionWithLocalSymbol(), <span class="keywordtype">string</span>.Empty, <span class="keyword">false</span>, null);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        <span class="comment">//Requesting data for an option contract will return the greek values</span></div>
<div class="line">        client.reqMktData(1002, ContractSamples.OptionWithLocalSymbol(), <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">false</span>, null);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        <span class="stringliteral">&#39;Requesting data for an option contract will return the greek values</span></div>
<div class="line"><span class="stringliteral">        client.reqMktData(1005, ContractSamples.USOptionContract(), String.Empty, False, Nothing)</span></div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    <span class="comment">//Requesting data for an option contract will return the greek values</span></div>
<div class="line">    m_pClient-&gt;reqMktData(1005, ContractSamples::USOptionContract(), <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">false</span>, TagValueListSPtr());</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        <span class="comment"># Requesting data for an option contract will return the greek values</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        self.reqMktData(1002, ContractSamples.OptionWithLocalSymbol(), <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">False</span>, <span class="keywordtype">None</span>)</div>
</div><!-- fragment -->  </li>
</ul>
<p>The Implied Volatility of an underlying based on its current option prices is returned in tick 24. See <a class="el" href="tick_types.html">Available Tick Types</a></p>
<p>The IB 30-day volatility is the at-market volatility estimated for a maturity thirty calendar days forward of the current trading day, and is based on option prices from two consecutive expiration months.</p>
<h1><a class="anchor" id="opt_calculations"></a>
Calculating option prices and historical volatility</h1>
<p>The implied volatility for an option given its price and the price of the underlying can be calculated with the function <a class="el" href="classIBApi_1_1EClient.html#a04c5d248c1036dd72435cc1edc7c58e2">IBApi.EClient.calculateImpliedVolatility</a></p>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">            client.calculateImpliedVolatility(5001, ContractSamples.OptionAtBOX(), 5, 85, null);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        client.calculateImpliedVolatility(5001, ContractSamples.OptionAtBOX(), 5, 85);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        <span class="stringliteral">&#39;** Calculating implied volatility ***</span></div>
<div class="line"><span class="stringliteral">        client.calculateImpliedVolatility(5001, ContractSamples.NormalOption(), 5, 85, Nothing)</span></div>
<div class="line"><span class="stringliteral">        &#39;</span>** Canceling implied volatility ***</div>
<div class="line">        client.cancelCalculateImpliedVolatility(5001)</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    m_pClient-&gt;calculateImpliedVolatility(5001, ContractSamples::NormalOption(), 5, 85);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        self.calculateImpliedVolatility(5001, ContractSamples.OptionAtBOX(), 5, 85, <span class="keywordtype">None</span>)</div>
</div><!-- fragment -->  </li>
</ul>
<p>Alternatively, given the price of the underlying and an implied volatility it is possible to calculate the option price using the function <a class="el" href="classIBApi_1_1EClient.html#a7afa53b655542e74ede683e1de2b2fc4">IBApi.EClient.calculateOptionPrice</a></p>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">            client.calculateOptionPrice(5002, ContractSamples.OptionAtBOX(), 0.22, 85, null);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        client.calculateOptionPrice(5002, ContractSamples.OptionAtBOX(), 0.22, 85);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        <span class="stringliteral">&#39;** Calculating option&#39;</span>s price ***</div>
<div class="line">        client.calculateOptionPrice(5002, ContractSamples.NormalOption(), 0.22, 85, Nothing)</div>
<div class="line">        <span class="stringliteral">&#39;** Canceling option&#39;</span>s price calculation ***</div>
<div class="line">        client.cancelCalculateOptionPrice(5002)</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    m_pClient-&gt;calculateOptionPrice(5002, ContractSamples::NormalOption(), 0.22, 85);</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;        self.calculateOptionPrice(5002, ContractSamples.OptionAtBOX(), 0.22, 85, <span class="keywordtype">None</span>)</div>
</div><!-- fragment -->  </li>
</ul>
<p>After the request, the option specific information will be delivered via the <a class="el" href="interfaceIBApi_1_1EWrapper.html#acacbf738e95ff9ffcc19b130f39938b3">IBApi.EWrapper.tickOptionComputation</a> method:</p>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">    <span class="keyword">public</span> <span class="keyword">class </span>EWrapperImpl : EWrapper </div>
<div class="line">    {</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">        <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> tickOptionComputation(<span class="keywordtype">int</span> tickerId, <span class="keywordtype">int</span> field, <span class="keywordtype">double</span> impliedVolatility, <span class="keywordtype">double</span> delta, <span class="keywordtype">double</span> optPrice, <span class="keywordtype">double</span> pvDividend, <span class="keywordtype">double</span> gamma, <span class="keywordtype">double</span> vega, <span class="keywordtype">double</span> theta, <span class="keywordtype">double</span> undPrice)</div>
<div class="line">        {</div>
<div class="line">            Console.WriteLine(<span class="stringliteral">&quot;TickOptionComputation. TickerId: &quot;</span>+tickerId+<span class="stringliteral">&quot;, field: &quot;</span>+field+<span class="stringliteral">&quot;, ImpliedVolatility: &quot;</span>+impliedVolatility+<span class="stringliteral">&quot;, Delta: &quot;</span>+delta</div>
<div class="line">                +<span class="stringliteral">&quot;, OptionPrice: &quot;</span>+optPrice+<span class="stringliteral">&quot;, pvDividend: &quot;</span>+pvDividend+<span class="stringliteral">&quot;, Gamma: &quot;</span>+gamma+<span class="stringliteral">&quot;, Vega: &quot;</span>+vega+<span class="stringliteral">&quot;, Theta: &quot;</span>+theta+<span class="stringliteral">&quot;, UnderlyingPrice: &quot;</span>+undPrice);</div>
<div class="line">        }</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>EWrapperImpl <span class="keyword">implements</span> EWrapper {</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">    @Override</div>
<div class="line">    <span class="keyword">public</span> <span class="keywordtype">void</span> tickOptionComputation(<span class="keywordtype">int</span> tickerId, <span class="keywordtype">int</span> field,</div>
<div class="line">            <span class="keywordtype">double</span> impliedVol, <span class="keywordtype">double</span> delta, <span class="keywordtype">double</span> optPrice,</div>
<div class="line">            <span class="keywordtype">double</span> pvDividend, <span class="keywordtype">double</span> gamma, <span class="keywordtype">double</span> vega, <span class="keywordtype">double</span> theta,</div>
<div class="line">            <span class="keywordtype">double</span> undPrice) {</div>
<div class="line">        System.out.println(<span class="stringliteral">&quot;TickOptionComputation. TickerId: &quot;</span>+tickerId+<span class="stringliteral">&quot;, field: &quot;</span>+field+<span class="stringliteral">&quot;, ImpliedVolatility: &quot;</span>+impliedVol+<span class="stringliteral">&quot;, Delta: &quot;</span>+delta</div>
<div class="line">                +<span class="stringliteral">&quot;, OptionPrice: &quot;</span>+optPrice+<span class="stringliteral">&quot;, pvDividend: &quot;</span>+pvDividend+<span class="stringliteral">&quot;, Gamma: &quot;</span>+gamma+<span class="stringliteral">&quot;, Vega: &quot;</span>+vega+<span class="stringliteral">&quot;, Theta: &quot;</span>+theta+<span class="stringliteral">&quot;, UnderlyingPrice: &quot;</span>+undPrice);</div>
<div class="line">    }</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    Public Class EWrapperImpl</div>
<div class="line">        Implements EWrapper</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line">        Public Sub tickOptionComputation(tickerId As Integer, field As Integer, impliedVolatility As Double, delta As Double, optPrice As Double, pvDividend As Double, gamma As Double, vega As Double, theta As Double, undPrice As Double) Implements IBApi.EWrapper.tickOptionComputation</div>
<div class="line">            Console.WriteLine(<span class="stringliteral">&quot;TickOptionComputation. TickerId: &quot;</span> &amp; tickerId &amp; <span class="stringliteral">&quot;, field: &quot;</span> &amp; field &amp; <span class="stringliteral">&quot;, ImpliedVolatility: &quot;</span> &amp; impliedVolatility &amp;</div>
<div class="line">                        <span class="stringliteral">&quot;, Delta: &quot;</span> &amp; delta &amp; <span class="stringliteral">&quot;, OptionPrice: &quot;</span> &amp; optPrice &amp; <span class="stringliteral">&quot;, pvDividend: &quot;</span> &amp; pvDividend &amp; <span class="stringliteral">&quot;, Gamma: &quot;</span> &amp; gamma &amp;</div>
<div class="line">                      <span class="stringliteral">&quot;, Vega: &quot;</span> &amp; vega &amp; <span class="stringliteral">&quot;, Theta: &quot;</span> &amp; theta &amp; <span class="stringliteral">&quot;, UnderlyingPrice: &quot;</span> &amp; undPrice)</div>
<div class="line">        End Sub</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><span class="keyword">class </span>TestCppClient : <span class="keyword">public</span> EWrapper</div>
<div class="line">{</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line"><span class="keywordtype">void</span> TestCppClient::tickOptionComputation( TickerId tickerId, TickType tickType, <span class="keywordtype">double</span> impliedVol, <span class="keywordtype">double</span> delta,</div>
<div class="line">                                          <span class="keywordtype">double</span> optPrice, <span class="keywordtype">double</span> pvDividend,</div>
<div class="line">                                          <span class="keywordtype">double</span> gamma, <span class="keywordtype">double</span> vega, <span class="keywordtype">double</span> theta, <span class="keywordtype">double</span> undPrice) {</div>
<div class="line">    printf( <span class="stringliteral">&quot;TickOptionComputation. Ticker Id: %ld, Type: %d, ImpliedVolatility: %g, Delta: %g, OptionPrice: %g, pvDividend: %g, Gamma: %g, Vega: %g, Theta: %g, Underlying Price: %g\n&quot;</span>, tickerId, (<span class="keywordtype">int</span>)tickType, impliedVol, delta, optPrice, pvDividend, gamma, vega, theta, undPrice);</div>
<div class="line">}</div>
</div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">class </span>TestWrapper(wrapper.EWrapper):</div>
</div><!-- fragment --> ... <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;    <span class="keyword">def </span>tickOptionComputation(self, reqId:TickerId, tickType:TickType ,</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;            impliedVol:float, delta:float, optPrice:float, pvDividend:float, </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;            gamma:float, vega:float, theta:float, undPrice:float):  </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        super().tickOptionComputation(reqId, tickType, impliedVol, delta,</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;                            optPrice, pvDividend, gamma, vega, theta, undPrice)</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        print(<span class="stringliteral">&quot;TickOptionComputation. TickerId:&quot;</span>, reqId, <span class="stringliteral">&quot;tickType:&quot;</span>, tickType, </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;            <span class="stringliteral">&quot;ImpliedVolatility:&quot;</span>, impliedVol, <span class="stringliteral">&quot;Delta:&quot;</span>, delta, <span class="stringliteral">&quot;OptionPrice:&quot;</span>, </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;            optPrice, <span class="stringliteral">&quot;pvDividend:&quot;</span>, pvDividend, <span class="stringliteral">&quot;Gamma: &quot;</span>, gamma, <span class="stringliteral">&quot;Vega:&quot;</span>, vega, </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;            <span class="stringliteral">&quot;Theta:&quot;</span>, theta, <span class="stringliteral">&quot;UnderlyingPrice:&quot;</span>, undPrice)</div>
</div><!-- fragment -->  </li>
</ul>
<p><br/>
<br/>
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.4-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">This website uses cookies. By navigating through it you agree to the use of cookies. Copyright Interactive Brokers 2016 </li>
  </ul>
</div>
<!--BEGIN GCS_SEARCHBOX-->
<style type='text/css'>
	.gsc-control-cse{
		font family: Arial, sans-serif;
		border-color: #000100;
		background-color: #000000;
		width:250px;
		height: 20px;
		padding-top: 6px;
	}
	input.gsc-search-button {
		background-color: #6D1800;
		color: #fff;
		cursor: pointer;
	}
	input.gsc-search-button:hover {
		background-color: #A02200;
	}
	td.gsc-clear-button {
		position: relative;
		right: 85px;
	}
  }
</style>
<!--END GCS_SEARCHBOX-->
</body>
</html>
