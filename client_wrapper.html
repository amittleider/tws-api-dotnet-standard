<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>TWS API v9.72+: API Software Architecture</title>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="https://www.interactivebrokers.com/favicon.ico" rel="shortcut icon">
<script>
$(document).ready(function(){
		var picked=getCookie("picked");
		if (picked != "") {
			if (!$(this).hasClass("active")) {
				var tabNum = $(this).index();
				var nthChild = picked;
				$("ul#tabs li.active").removeClass("active");
				$(this).addClass("active");
				$("ul#tab li.active").removeClass("active");
				$("ul#tab li:nth-child("+nthChild+")").addClass("active");
				$("ul#tabs li:nth-child("+nthChild+")").addClass("active");
				setCookie("picked", nthChild, 1);
			}
		}
		$("ul#tabs li").click(function(e){
			if (!$(this).hasClass("active")) {
			var tabNum = $(this).index();
			var nthChild = tabNum+1;
			$("ul#tabs li.active").removeClass("active");
			$(this).addClass("active");
			$("ul#tab li.active").removeClass("active");
			$("ul#tab li:nth-child("+nthChild+")").addClass("active");
			setCookie("picked", nthChild, 1);
		}
    });
});
function setCookie(cname, cvalue, exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    var expires = "expires="+d.toUTCString();
    document.cookie = cname + "=" + cvalue + "; " + expires;
} 
function getCookie(cname) {
    var name = cname + "=";
    var ca = document.cookie.split(';');
    for(var i=0; i<ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1);
        if (c.indexOf(name) == 0) return c.substring(name.length,c.length);
    }
    return "";
} 
function checkCookie() {
    var picked=getCookie("picked");
    if (picked != "") {
        alert("Welcome again " + picked);
    }else{
        //username = prompt("Please enter your name:", "");
        if (picked != "" && picked != null) {
            setCookie("picked", 1, 365);
        }
    }
}
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ib_theme.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" style="background-color:black;">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr>
  <td id="projectlogo"><img alt="Logo" src="nav_iblogo.png"/></a></td>
  <td style="padding: 0 0 0 1em;">
   <ul id="tabs"><li class="active">C#</li><li>Java</li><li>VB</li><li>C++</li><li>Python</li></ul>
  </td>
  <td><a href="https://www.interactivebrokers.com/en/index.php?f=customerService&p=email" style="color:#C7C7C7;font-weight:bold;padding: 0 0 0 1em;">Contact us</a></td>
  <!--BEGIN GCS_SEARCHBOX-->
  <td style="position: absolute; right: 0;">
   <div id="google-custom-search" align="right" style="vertical-align: top;">
   <script>
  (function() {
    var cx = '002885114636493240026:q6smajphkxq';
	var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
	</script>
	<gcse:search newWindow="false" enableHistory="true"></gcse:search>
   </div>
   </td>
  <!--END !GCS_SEARCHBOX-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('client_wrapper.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">API Software Architecture </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="The"></a>
EClientSocket and EWrapper Classes</h1>
<p>Once the TWS is up and running and actively listening for incoming connections we are ready to write our code. This brings us to the TWS API's two major classes: the <a class="el" href="interfaceIBApi_1_1EWrapper.html">IBApi.EWrapper</a> interface and the <a class="el" href="classIBApi_1_1EClientSocket.html">IBApi.EClientSocket</a></p>
<h1><a class="anchor" id="ewrapper_impl"></a>
Implementing the EWrapper Interface</h1>
<p>The <a class="el" href="interfaceIBApi_1_1EWrapper.html">IBApi.EWrapper</a> interface is the mechanism through which the TWS delivers information to the API client application. By implementing this interface the client application will be able to receive and handle the information coming from the TWS. For further information on how to implement interfaces, refer to your programming language's documentation.</p>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">    <span class="keyword">public</span> <span class="keyword">class </span>EWrapperImpl : EWrapper </div><div class="line">    {</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>EWrapperImpl <span class="keyword">implements</span> EWrapper {</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    Public Class EWrapperImpl</div><div class="line">        Implements EWrapper</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><span class="keyword">class </span>TestCppClient : <span class="keyword">public</span> EWrapper</div><div class="line">{</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">class TestWrapper(wrapper.EWrapper):</div></div><!-- fragment -->  </li>
</ul>
<h1><a class="anchor" id="client_socket"></a>
The EClientSocket Class</h1>
<p>The class used to send messages to TWS is <a class="el" href="classIBApi_1_1EClientSocket.html">IBApi.EClientSocket</a>. Unlike EWrapper, this class is not overriden as the provided functions in EClientSocket are invoked to send messages to TWS. To use EClientSocket, first it may be necessary to implement the <a class="el" href="interfaceIBApi_1_1EWrapper.html">IBApi.EWrapper</a> interface as part of its constructor parameters so that the application can handle all returned messages. Messages sent from TWS as a response to function calls in <a class="el" href="classIBApi_1_1EClientSocket.html">IBApi.EClientSocket</a> require a EWrapper implementation so they can processed to meet the needs of the API client.</p>
<p>Another crucial element is the <a class="el" href="interfaceIBApi_1_1EReaderSignal.html">IBApi.EReaderSignal</a> object passed to theEClientSocket's constructor. With the exception of Python, this object is used in APIs to signal a message is ready for processing in the queue. (In Python the Queue class handles this task directly). We will discuss this object in more detail in the <a class="el" href="connection.html#ereader">The EReader Thread</a> section.</p>
<ul id="tab">
<li class="active">
<div class="fragment"><div class="line">        EClientSocket clientSocket;</div><div class="line">        <span class="keyword">public</span> readonly EReaderSignal Signal;</div></div><!-- fragment --> ... <div class="fragment"><div class="line">        <span class="keyword">public</span> EWrapperImpl()</div><div class="line">        {</div><div class="line">            Signal = <span class="keyword">new</span> EReaderMonitorSignal();</div><div class="line">            clientSocket = <span class="keyword">new</span> EClientSocket(<span class="keyword">this</span>, Signal);</div><div class="line">        }</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    <span class="keyword">private</span> EReaderSignal readerSignal;</div><div class="line">    <span class="keyword">private</span> EClientSocket clientSocket;</div><div class="line">    <span class="keyword">protected</span> <span class="keywordtype">int</span> currentOrderId = -1;</div></div><!-- fragment --> ... <div class="fragment"><div class="line">    <span class="keyword">public</span> EWrapperImpl() {</div><div class="line">        readerSignal = <span class="keyword">new</span> EJavaSignal();</div><div class="line">        clientSocket = <span class="keyword">new</span> EClientSocket(<span class="keyword">this</span>, readerSignal);</div><div class="line">    }</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">        Public eReaderSignal As EReaderSignal</div><div class="line">        Public socketClient As EClientSocket</div></div><!-- fragment --> ... <div class="fragment"><div class="line">        Sub New()</div><div class="line">            eReaderSignal = New EReaderMonitorSignal</div><div class="line">            socketClient = New EClientSocket(Me, eReaderSignal)</div><div class="line">        End Sub</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line">    EReaderOSSignal m_osSignal;</div><div class="line">    EClientSocket * <span class="keyword">const</span> m_pClient;</div></div><!-- fragment --> ... <div class="fragment"><div class="line">TestCppClient::TestCppClient() :</div><div class="line">      m_osSignal(2000)<span class="comment">//2-seconds timeout</span></div><div class="line">    , m_pClient(new EClientSocket(this, &amp;m_osSignal))</div><div class="line">    , m_state(ST_CONNECT)</div><div class="line">    , m_sleepDeadline(0)</div><div class="line">    , m_orderId(0)</div><div class="line">    , m_pReader(0)</div><div class="line">    , m_extraAuth(false)</div><div class="line">{</div><div class="line">}</div></div><!-- fragment -->  </li>
<li>
<div class="fragment"><div class="line"><span class="keyword">class </span>TestClient(EClient):</div><div class="line">    <span class="keyword">def </span>__init__(self, wrapper):</div><div class="line">        EClient.__init__(self, wrapper)</div></div><!-- fragment --> ... <div class="fragment"><div class="line"><span class="keyword">class </span>TestApp(TestWrapper, TestClient):</div><div class="line">    <span class="keyword">def </span>__init__(self):</div><div class="line">        TestWrapper.__init__(self)</div><div class="line">        TestClient.__init__(self, wrapper=self)</div></div><!-- fragment --> <em><b>Note: </b> The EReaderSignal class is not used for Python API. The Python Queue module is used for inter-thread communication and data exchange.</em>  </li>
</ul>
<p><br />
<br />
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.4-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">This website uses cookies. By navigating through it you agree to the use of cookies. Copyright Interactive Brokers 2016 </li>
  </ul>
</div>
<!--BEGIN GCS_SEARCHBOX-->
<style type='text/css'>
	.gsc-control-cse{
		font family: Arial, sans-serif;
		border-color: #000100;
		background-color: #000000;
		width:260px;
		height: 20px;
		padding-top: 6px;
	}
	input.gsc-search-button {
		background-color: #6D1800;
		color: #fff;
		cursor: pointer;
	}
	input.gsc-search-button:hover {
		background-color: #A02200;
	}
	td.gsc-clear-button {
		position: relative;
		right: 85px;
	}
  }
</style>
<!--END GCS_SEARCHBOX-->
</body>
</html>
